{% comment %}
  ORÉA Related Products Section
  Displays curated product recommendations
{% endcomment %}

<div class="space-y-16">
  <div class="text-center space-y-4">
    <h3 class="text-4xl font-light text-stone-900 font-serif italic">
      {{ section.settings.heading }}
    </h3>
    <p class="text-[10px] font-bold uppercase tracking-[0.3em] text-stone-400">
      {{ section.settings.subheading }}
    </p>
  </div>
  
  <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-8">
    {% if section.settings.product_list != blank %}
      {% for product in section.settings.product_list %}
        <div class="group cursor-pointer">
          <a href="{{ product.url }}">
            <div class="bg-stone-50 aspect-[3/4] overflow-hidden mb-6 relative">
              {% if product.featured_image %}
                <img 
                  src="{{ product.featured_image | image_url: width: 600 }}" 
                  alt="{{ product.title | escape }}" 
                  class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"
                  loading="lazy"
                />
              {% else %}
                <div class="w-full h-full flex items-center justify-center bg-stone-100">
                  <svg class="w-16 h-16 text-stone-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M12 2L4.5 9L12 22L19.5 9L12 2Z" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M4.5 9H19.5" stroke-width="0.8" />
                  </svg>
                </div>
              {% endif %}
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors duration-500"></div>
            </div>
            <div class="space-y-1 text-center lg:text-left">
              <h4 class="text-[11px] font-bold uppercase tracking-[0.15em] text-stone-800">
                {{ product.title }}
              </h4>
              <p class="text-[13px] text-stone-500 font-light">
                {{ product.price | money }} {{ cart.currency.iso_code }}
              </p>
            </div>
          </a>
        </div>
      {% endfor %}
    {% else %}
      <!-- Fallback: Show products from same collection or type -->
      {% assign related_products = product.collections.first.products | where_exp: "p", "p.id != product.id" | limit: 4 %}
      {% if related_products.size == 0 %}
        {% assign related_products = collections.all.products | where_exp: "p", "p.id != product.id" | limit: 4 %}
      {% endif %}
      
      {% for related_product in related_products %}
        <div class="group cursor-pointer">
          <a href="{{ related_product.url }}">
            <div class="bg-stone-50 aspect-[3/4] overflow-hidden mb-6 relative">
              {% if related_product.featured_image %}
                <img 
                  src="{{ related_product.featured_image | image_url: width: 600 }}" 
                  alt="{{ related_product.title | escape }}" 
                  class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"
                  loading="lazy"
                />
              {% else %}
                <div class="w-full h-full flex items-center justify-center bg-stone-100">
                  <svg class="w-16 h-16 text-stone-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M12 2L4.5 9L12 22L19.5 9L12 2Z" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M4.5 9H19.5" stroke-width="0.8" />
                  </svg>
                </div>
              {% endif %}
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors duration-500"></div>
            </div>
            <div class="space-y-1 text-center lg:text-left">
              <h4 class="text-[11px] font-bold uppercase tracking-[0.15em] text-stone-800">
                {{ related_product.title }}
              </h4>
              <p class="text-[13px] text-stone-500 font-light">
                {{ related_product.price | money }} {{ cart.currency.iso_code }}
              </p>
            </div>
          </a>
        </div>
      {% endfor %}
      
      {% if related_products.size == 0 %}
        <!-- Placeholder items when no products available -->
        {% for i in (1..4) %}
          <div class="group cursor-pointer">
            <div class="bg-stone-50 aspect-[3/4] overflow-hidden mb-6 relative flex items-center justify-center">
              <svg class="w-16 h-16 text-stone-200" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2L4.5 9L12 22L19.5 9L12 2Z" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M4.5 9H19.5" stroke-width="0.8" />
              </svg>
            </div>
            <div class="space-y-1 text-center lg:text-left">
              <h4 class="text-[11px] font-bold uppercase tracking-[0.15em] text-stone-300">Coming Soon</h4>
              <p class="text-[13px] text-stone-300 font-light">—</p>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Related Products",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Complete the Look"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Curated Pairings for the Solitaire"
    },
    {
      "type": "product_list",
      "id": "product_list",
      "label": "Products",
      "limit": 4
    }
  ]
}
{% endschema %}
